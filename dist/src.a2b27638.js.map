{"version":3,"sources":["src/database.json","src/index.js"],"names":["module","exports","_database","_interopRequireDefault","require","obj","__esModule","default","DISCOUNT_PERCENTAGE","DISCOUNT_THRESHOLD","DISCOUNT_AMOUNT","checkout","productIDs","arguments","length","undefined","products","database","discounts","cartItems","map","id","index","_products$id","name","price","originalPrice","finalPrice","forEach","item","cart","totalPrice","reduce","total","result","appContainer","document","getElementById","priceElement","concat","emptyLine","tableElement","_ref","join","innerHTML"],"mappings":"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","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["module.exports = {\n  \"products\": {\n    \"001\": {\n      \"name\": \"Cola\",\n      \"price\": 45\n    },\n    \"002\": {\n      \"name\": \"Royal\",\n      \"price\": 50\n    },\n    \"003\": {\n      \"name\": \"Sprite\",\n      \"price\": 55\n    },\n    \"004\": {\n      \"name\": \"Fanta\",\n      \"price\": 60\n    },\n    \"005\": {\n      \"name\": \"Lemon Tea\",\n      \"price\": 35\n    }\n  }\n}\n;","import database from \"./database.json\";\n\nconst DISCOUNT_PERCENTAGE = 0.5;\nconst DISCOUNT_THRESHOLD = 3;\nconst DISCOUNT_AMOUNT = 5;\n\nexport const checkout = (productIDs = []) => {\n  const products = database.products;\n  const discounts = {};\n\n  const cartItems = productIDs.map((id, index) => {\n    const { name, price } = products[id];\n\n    return {\n      index: index + 1,\n      id,\n      name,\n      originalPrice: price,\n      finalPrice: price,\n    };\n  });\n\n  if (cartItems.length < DISCOUNT_THRESHOLD) {\n    cartItems.forEach((item, index) => {\n      const { id } = item;\n\n      if (discounts[id] === undefined) {\n        discounts[id] = index;\n      } else {\n        item.finalPrice *= DISCOUNT_PERCENTAGE;\n      }\n    });\n  } else {\n    cartItems.forEach((item, index) => {\n      const { id } = item;\n\n      if (discounts[id] === undefined) {\n        discounts[id] = index;\n        item.finalPrice -= DISCOUNT_AMOUNT;\n      } else if (discounts[id] !== -1) {\n        cartItems[discounts[id]].finalPrice += DISCOUNT_AMOUNT;\n        item.finalPrice *= DISCOUNT_PERCENTAGE;\n        discounts[id] = -1;\n      } else {\n        item.finalPrice -= DISCOUNT_AMOUNT;\n      }\n    });\n  }\n\n  return {\n    cart: cartItems,\n    totalPrice: cartItems.reduce((total, item) => total + item.finalPrice, 0),\n  };\n};\n\nconst result = checkout([\"003\", \"002\", \"003\", \"003\", \"004\"]);\n\nconst appContainer = document.getElementById(\"app\");\n\nconst priceElement = `<p>價格。以本範例為例，價格為：$${result.totalPrice}</p>`;\n\nconst emptyLine = \"<p>\\n</p>\";\n\nconst tableElement = `\n  <table style=\"text-align: center;\">\n    <thead>\n      <tr>\n        <th>#</th>\n        <th>ID</th>\n        <th>原價</th>\n        <th>活動價</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr>\n        <td colspan=\"4\">\n          ----------------------------------------------------\n        </td>\n      </tr>\n      ${result.cart\n        .map(\n          ({ index, id, originalPrice, finalPrice }) => `\n            <tr>\n              <td>${index}</td>\n              <td>${id}</td>\n              <td>${originalPrice}</td>\n              <td>${finalPrice}</td>\n            </tr>\n          `\n        )\n        .join(\"\")}\n    </tbody>\n  </table>\n`;\n\nif (appContainer) {\n  appContainer.innerHTML = priceElement + emptyLine + tableElement;\n}\n"]}